[{"title":"python Collection类","date":"2017-01-08T05:18:20.000Z","path":"2017/01/08/python-Collection类/","text":"python collections 一直都躺在todolist里 具体实现方法参考文档：https://docs.python.org/3/library/collections.html container datetypes abstract Cool deque 双端序列 有得必有失 Counter 统计hashable objects 类似sql中的sum(A)…group by id OrderedDict 顺序存取的字典 None defaultdict key不存在时，赋予value默认值 实时统计玩家参与某副本的次数 namedtuple() 使tuple内的元素有自己的名称 坐标（x，y） 还有一些其他的类如ChainMap，暂时未归纳 主要说说defaultdict这个类想到的一些东西 在实时获取玩家参与某个玩家的次数时，由于玩家id唯一，一般作为key，使用dict比较方便，还可以应用json （听说有另外一个ujson更好用，慢慢看吧）格式进行交互，但是一开始没有进入统计范围的玩家，获取key时会报错，使用defaultdict可以解决这个问题 1234567891011# 普通字典In [7]: d = &#123;&#125;In [8]: d['a']---------------------------------------------------------------------------KeyError Traceback (most recent call last)&lt;ipython-input-8-169a40407b7f&gt; in &lt;module&gt;()----&gt; 1 d['a']KeyError: 'a' 1234567# defaultdictIn [4]: from collections import defaultdictIn [5]: d = defaultdict(int)In [6]: d['a']Out[6]: 0 实现hive中collect_all() 函数的函数,本来想在sqlite3上实现一下，但貌似不支持这个方法。 color count yellow 1 blue 2 yellow 3 blue 4 red 1 hive sql：1select color, collect_list(count) from test group by color difaultdict：12345678910In [19]: s = [('yellow', 1), ('blue', 2), ('yellow', 3), ('blue', 4), ('red', 1)]In [20]: d = defaultdict(list)In [21]: for k, v in s: ...: d[k].append(v) ...:In [22]: dOut[22]: defaultdict(list, &#123;'blue': [2, 4], 'red': [1], 'yellow': [1, 3]&#125;) 图床抽风用不了截图，就凑合着，中午没吃饭，又困又饿…","comments":true,"tags":[{"name":"python","slug":"python","permalink":"http://blog.canying.org/tags/python/"}]},{"title":"openpyxl操作excel文件","date":"2016-12-31T02:46:29.000Z","path":"2016/12/31/openpyxl操作excel文件 /","text":"这个完全是为了熟悉hexo和markdown语法，上周末生日，来自一位朋友的工作需求 需求描述需要将目录中的每一行数据分别建立单独的工作表，应用工作表1的模板，并填入对于应的数据（红色框部分） 实现效果： 实现过程第一步：批量生成指定名称的工作表，excel可直接操作 选中“桥梁名称”列，先Alt+D，再Alt+P，插入数据透视表 在数据透视表字段，将“桥梁名称”拖拽到筛选区域 透视表“选项”，选择“显示报表筛选页”，确定 参考：http://jingyan.baidu.com/article/6fb756ec8c6703241858fbba.html 第二步：复制模板到各个工作表这里只需要复制模板，全选模板内容，按住shift全选工作表，Ctrl+V复制即可 第三步：填入数据这应该是可以直接用excel完成的，比较菜，不会，选择了python openpyxl 模块操作excel的方式参考openpyxl文档：http://openpyxl.readthedocs.io/en/default/usage.html 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# -*- coding:utf-8 -*-from openpyxl import load_workbookwb = load_workbook(filename = u\"xxx.xlsx\")ws1 = wb.get_sheet_by_name(wb.get_sheet_names()[-2])print ws1.titlehangshu = ws1.get_highest_row()content = &#123;&#125;def get_content(): for i in range(2,217): if i &lt; 11: key = '00' + str(i-1) elif i &lt; 101: key = '0' + str(i-1) else: key = str(i-1) name_index = 'C' + str(i) bianhao_index = 'B' + str(i) dengji_index = 'H' + str(i) xunhao_index = 'K' + str(i) name = ws1[name_index].value keyname = key + name bianhao = ws1[bianhao_index].value dengji = ws1[dengji_index].value xunhao = ws1[xunhao_index].value content[keyname] = [bianhao, dengji, xunhao, name] return contentcontent = get_content()ll = 0for j in wb.get_sheet_names(): print j print content[j][3] wb.get_sheet_by_name(j)['B3'] = content[j][3] wb.get_sheet_by_name(j)['D3'] = content[j][0] wb.get_sheet_by_name(j)['F3'] = content[j][1] wb.get_sheet_by_name(j)['F26'] = content[j][2] ll += 1 if ll &gt; 214: break wb.save(filename = 'aaa_test1.xlsx')","comments":true,"tags":[{"name":"python","slug":"python","permalink":"http://blog.canying.org/tags/python/"},{"name":"excel","slug":"excel","permalink":"http://blog.canying.org/tags/excel/"}]},{"title":"hello-world","date":"2016-12-24T00:37:25.491Z","path":"2016/12/24/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","comments":true,"tags":[]}]