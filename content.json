[{"title":"test2","date":"2016-12-31T04:03:08.000Z","path":"2016/12/31/test2/","text":"","comments":true,"excerpt":"","tags":[]},{"title":"openpyxl操作excel文件","date":"2016-12-31T02:46:29.000Z","path":"2016/12/31/test/","text":"这个完全是为了熟悉hexo和markdown语法，上周末生日，来自一位朋友的工作需求 需求描述需要将目录中的每一行数据分别建立单独的工作表，应用工作表1的模板，并填入对于应的数据（红色框部分） 实现效果： 实现过程第一步：批量生成指定名称的工作表，excel可直接操作 选中“桥梁名称”列，先Alt+D，再Alt+P，插入数据透视表 在数据透视表字段，将“桥梁名称”拖拽到筛选区域 透视表“选项”，选择“显示报表筛选页”，确定 参考：http://jingyan.baidu.com/article/6fb756ec8c6703241858fbba.html 第二步：复制模板到各个工作表这里只需要复制模板，全选模板内容，按住shift全选工作表，Ctrl+V复制即可 第三步：填入数据这不应该是可以直接用excel完成的，比较菜，不会，选择了python openpyxl 模块操作excel的方式参考openpyxl文档：http://openpyxl.readthedocs.io/en/default/usage.html 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# -*- coding:utf-8 -*-from openpyxl import load_workbookimport sysreload(sys)sys.setdefaultencoding('utf-8')wb = load_workbook(filename = u\"xxx.xlsx\")ws1 = wb.get_sheet_by_name(wb.get_sheet_names()[-2])print ws1.titlehangshu = ws1.get_highest_row()content = &#123;&#125;def get_content(): for i in range(2,217): if i &lt; 11: key = '00' + str(i-1) elif i &lt; 101: key = '0' + str(i-1) else: key = str(i-1) name_index = 'C' + str(i) bianhao_index = 'B' + str(i) dengji_index = 'H' + str(i) xunhao_index = 'K' + str(i) name = ws1[name_index].value keyname = key + name bianhao = ws1[bianhao_index].value dengji = ws1[dengji_index].value xunhao = ws1[xunhao_index].value content[keyname] = [bianhao, dengji, xunhao, name] return contentcontent = get_content()ll = 0for j in wb.get_sheet_names(): print j print content[j][3] wb.get_sheet_by_name(j)['B3'] = content[j][3] wb.get_sheet_by_name(j)['D3'] = content[j][0] wb.get_sheet_by_name(j)['F3'] = content[j][1] wb.get_sheet_by_name(j)['F26'] = content[j][2] ll += 1 if ll &gt; 214: break wb.save(filename = 'aaa_test1.xlsx')","comments":true,"excerpt":"","tags":[{"name":"python","slug":"python","permalink":"http://blog.canying.org/tags/python/"},{"name":"excel","slug":"excel","permalink":"http://blog.canying.org/tags/excel/"}]},{"title":"???","date":"2016-12-24T00:37:25.491Z","path":"2016/12/24/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","comments":true,"excerpt":"","tags":[]}]